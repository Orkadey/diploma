__Слайд 1.__ Добрый день, уважаемые члены комиссии, темой представляемой дипломной работы является «Криминалистически правильные методы извлечения дампов оперативной памяти виртуальных машин в контексте платформы виртуализации QEMU/KVM».

Слайд 2. В настоящее время центральное место в ИТ-инфраструктурах всё чаще занимают облачные технологии, основанные на использовании платформ виртуализации. С ростом киберпреступности под ударом оказываются как виртуальные окружения, так и инфраструктура, лежащая в их основе. Таким образом, растет необходимость в создании систем безопасности для противостояния внешним и внутренним угрозам в виртуализованных средах. Традиционные средства защиты операционных систем, обеспечивают безопасность, используя перманентные агенты, установленные непосредственно внутри целевых систем, что делает их уязвимыми перед вредоносным ПО. 

Слайд 3. В случае облачных технологий наиболее эффективным является подход к противодействию несанкционированной активности внутри целевых систем, основанный на механизме интроспекции виртуальных машин для мониторинга и анализа операционных систем извне (со стороны гипервизора).

Слайд 4. При этом наибольший интерес представляют методы, имеющие в своей основе принципы компьютерной криминалистики и основанные на извлечении и анализе дампов оперативной памяти. Тематикой данной работы является исключительно извлечение компьютерной информации, при этом криминалистически правильные методы должны придерживаться определенных требований:
•	сохранение целостности и достоверности данных;
•	предотвращение «загрязнения» данных;
•	полная и правильная документация;
•	реализация правильных научных методов.

Слайд 5. Далее определим эталонный метод как криминалистически правильный, что также означает его неинвазивность. Кроме того эталонный метод не требует остановки работы виртуальной машины.

Слайд 6. Задачи работы включают:
1.	обзор архитектуры QEMU/KVM;
2.	обзор методов получения дампов оперативной памяти;
3.	разработка семейства криминалистически правильных методов получения дампов памяти виртуальных машин; реализация эталонного метода;
4.	проведение вычислительного эксперимента для верификации разработанных методов.

Слайд 7. QEMU/KVM является программным комплексом, использующим в качестве основы QEMU - гипервизор второго типа и пользующимся модулем ядра KVM, который преобразует ядро операционной системы Linux в гипервизор первго типа, тем самым добиваясь высокой производительности. Общая архитектура QEMU/KVM представлена на слайде. Запущенная виртуальная машина располагается целиком в адресном пространстве процесса QEMU. Каждый виртуальный процессор представляет из себя поток процесса QEMU. QEMU использует преимущества параллельной и событийной архитектур, т. е. разделяет работу по процессам и потокам, которые могут выполняться одновременно и реагирует на события внутри главного цикла обработки событий. iothread выполняет цикл для обработки пакетных операций сетевых соединений, дисковых операций ввода/вывода и т. п.

Слайд 8. Для управления памятью виртуальной машины гипервизор представляет ее как ацикличский граф, где листьями являются регионами памяти, представляющие RAM и MMIO, остальные узлы представляют шины, контролеры памяти и перенаправленные регионы памяти  в виде контейнеров и alias-регионов. Соответсвующий API позволяет получать доступ к регионам памяти.

Слайд 9. Следует отметить, что гипервизор предоставляет возможности балунинга и горячего добавления памяти. Балунинг позволяет перераспределять оперативную память виртуальных машин, однако, в отличие от горячего добавления памяти, хостом не прослеживаются изменения в перераспределении ресурсов.

Слайд 10. Не останавливаясь подробно на существующих группах методов, могу сказать, что среди них эталонные методы потенциально присутствуют в группе подходов, использующих чтение памяти процесса, однако соответсвующие проекты находятся в разработке и к тому же не учитывают возможное использование балунинга памяти.

Слайд 11. Общий алгоритм реализованного метода представлен на слайде. Основные шаги включают создание хранилища дампа и копирование блоков памяти.

Слайд 12. В зависимости от контекста решаемой задачи, дамп может храниться либо в оперативной памяти, либо на жестком диске. При этом выделение региона памяти осуществляется с помощью функции mmap(), поскольку это обеспечивает оптимальный вариант при работе с большими массивами данных. Причиной этому служит низкая гранулярность применяемых в данном случае операций, что уменьшает число обращений к операционной системе. Другой важной причиной является то, что операционная система оптимизированно обрабатывает запросы на чтение и запись, применяя операции только в случае необходимости.

Слайд 13. Непосредственному копированию блока оперативной памяти предшествует наложение блокировки с помощью функции rcu_read_lock(). Ключевое свойство такой блокировки заключается в том, что потоки, производящие чтение, могут получать доступ к данным, даже если происходит их обновление. Такой эффект достигается за счет дополнительных затрат на сохранение старой версии данных. Так как достаточно значительную часть оперативной памяти составляют статичные структуры, такая блокировка не несет неприемлемых затрат, при этом она обеспечивает целостность считываемых данных.

Слайд 14. Вызов соответствующих функций гипервизора осуществляется посредством QMP (QEMU Machine Protocol), базирующегося на формате JSON. Далее, используя формат сериализации External Data Representation (XDR), данная команда передается гипервизору в виде сообщения, где после процедуры десериализации сообщения гипервизор выполняет необходимые действия.

Слайд 15. Выполнение команды гипервизором. В рассматриваемом случае выполняется команда pmemsave. Данная команда, обработанная в главном цикле, вызывает соответствующую функцию qmp_pmemsave(). Сначала производится поиск соответствующего блока памяти процесса в соответствии с ранее представленной организацией памяти. Далее производится чтение из блока памяти в буфер при помощи функции memcpy(). Далее этап завершается возвращением результата хосту аналогично отправке сообщения гипервизору, снимается блокировка, освобождаются ресурсы.

Слайд 16. Поставим эксперимент для сравнения реализованного метода с существующими, покажем что он является эталонным и проведем необходимые проверки.

Слайд 17. На приведенном слайде показано, каким образом проверялись характеристики и что обеспечивает наличие каждой из них.Ппервые три характеристики: целостность блока копируемой памяти, корректность дампа и неинвазивность вместе составляют криминалистическую правильность метода. Контрольные суммы блоков считались с помощью алгоритма SHA256 для блоков непосредственно перед копированием и для результирующего содержимого буфера. Volatility framework проверяет дампы памяти на соответствие стандартам форматов дампов памяти и позволяет извлекать информацию о состоянии оперативной памяти из файлов образов. Применение Volatility позволило сравнить информацию об оперативной памяти и показало корректность полученного дампа.

Слайд 18. В данной работе была рассмотрена архитектура платформы виртуализации QEMU/KVM и изучены основные подходы к криминалистически правильному получению дампов оперативной памяти виртуальных машин. На основе приобретенных знаний был разработан криминалистически правильный метод, не требующий остановки целевой системы.
Спасибо за внимание, пожалуйста, задавайте вопросы.

